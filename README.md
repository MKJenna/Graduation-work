# Graduation-work
Выпускная квалификационная работа на тему "Разработка алгоритма прогнозирования потребления электрической энергии промышленным предприятием"

Прогнозирование потребления электроэнергии является сложным и важным процессом для промышленных предприятий. Точность прогноза на ближайшее время позволяет не только избежать дополнительных затрат на энергию, но и оптимизировать производственные процессы. Для достижения этой цели необходимо использовать гибкие решения, обеспечивающие точный и интерпретируемый результат в короткие сроки.

В данной работе проводилось сравнение нескольких методов прогнозирования временных рядов с целью использовать наилучший как основу для дальнейшего составления алгоритма прогнозирования потребления электроэнергии промышленным предприятием. Для оценки качества использовались коэффициент детерминации, средняя абсолютная ошибка, замеры время на подбор параметров, обучение, прогноз модели, а также среднеквадратичная и средняя абсолютная ошибки.

Были использованы данные о потреблении электроэнергии лесопромышленным предприятием ООО «Харовсклеспром» по часовым интервалам за период с января 2017 года по декабрь 2020 года. Исходный датасет содержал 35 063 наблюдения и не имел пропущенных значений. Для анализа данных были использованы различные методы визуализации, такие как гистограммы, ящик с усами и линейные графики. Анализ помесячного потребления электроэнергии на примере 2018 года показал, что существует дневная динамика потребления, которая позволила сделать относительно точный прогноз с помощью наивного сезонного прогноза – MAPE 12,69%, R2 0,81.

Использование статистических моделей ARIMA и SARIMA оказалось нецелесообразным на представленных данных из-за низкого качества прогноза и большого количества времени, требующего на обучение модели и построение прогноза. Кроме этого, модели не могу обработать слишком большое количество данных, и почасовой временной ряд приходится ограничить последними несколькими месяцами, что может привести к потере закономерности.

Многослойный перцептрон и случайный лес без дополнительных надстроек позволяют снизить ошибку до 9-10%. Случайный лес требует значительного времени на обучение (30-40 минут для данных за четыре года), однако прогнозы этой модели в среднем точнее, чем у перцептрона.  Дальнейший анализ показал, что случайный лес позволяет снизить ошибку  на 1,5% при введении дополнительных переменных, хотя требуется проводить тщательный отбор признаков. При этом новые признаки могут быть основаны исключительно на данный о потреблении, дате и времени, что может быть хорошо для предприятий, которые не могут вести учет других показателей и погоды. 

Было показано, что при использовании многослойного перцептрона и случайного леса для временного ряда не требуется проводить стандартизацию и нормализацию – это приведет к значительному ухудшению прогноза. 

Важную роль при работе с временным рядом играет ширина окна. Хотя этот параметр можно подобрать по визуальному анализу графика, следует провести дополнительные эксперименты. Так, хотя при анализе данных было предположено, что модели будут давать наилучший результат при окне 24*7, оказалось, что многослойный перцептрон лучше улавливает закономерности на данных за последние четыре дня, а случайный лес – за последние пять.

Кроме введения дополнительных переменных попытаться повысить качество прогноза можно путем добавления моделей, которые будут заточены на прогнозирования проблемных участков основной модели: прогнозировании на основе неучтённых закономерностях в остатках, прогнозировании минимальных и максимальных потреблений в будущих сутках.

В работе приведен алгоритм прогнозирования потребления электроэнергии, который на данных за четыре года ООО «Харовсклеспрома» позволил достичь ошибки в 9%. Получившийся прогноз на семь дней вперед достаточно точно повторяет динамику дневного потребления, но не всегда верно предсказывает поведение на пике потребления, что приводит к потере точности.

Проведенные в ходе разработки исследования могут послужить отправной точкой для дальнейшего изучения проблемы с целью добиться еще меньшей ошибки. Благодаря своей интерпретируемости случайный лес может позволить оптимизировать процессы на производстве, что наравне с довольно высокой скорости работы модели также является преимуществом алгоритма. 

